
# Advection-Diffusion Equation Solver

By Dev Hathi (dev.hathi@tum.de) and Harikrishnan Anathazhath (ge83rat@mytum.de)

## Motivation

The [advection-diffusion equation](https://en.wikipedia.org/wiki/Convection%E2%80%93diffusion_equation) is an important partial differential equation which can model phenomena such as the transport of a scalar, reaction-diffusion processes, semiconductor physics, etc. By tweaking the equation parameters, the advection and diffusion equations can also be solved individually, with applications in shockwave propogation, heat transfer, etc. As this equation only has analytical solutions for some specific cases, this project aims to solve the advection-diffusion equation numerically using the [Finite Volume Method](https://en.wikipedia.org/wiki/Finite_volume_method).

## Implementation Details

The differential form of the two-dimensional advection-diffusion equation is given as:

```math
\frac{\partial \phi}{\partial t}+u\frac{\partial \phi}{\partial x}+v\frac{\partial \phi}{\partial y}= D(\frac{\partial^2 \phi}{\partial x^2}+\frac{\partial^2 \phi}{\partial y^2})
```

Here, $\phi$ is the scalar being solved for, $u$ and $v$ are the advection velocities and $D$ is the diffusion coefficient. The RHS of the equation represents the diffusion term, whereas in the LHS, the first term is the temporal term and the other two terms represent the advection term, responsible for the bulk transport of the scalar.

The current formulation uses the methodology described by [Versteeg and Malalasekara (2007)](https://www.pearson.com/en-gb/subject-catalog/p/introduction-to-computational-fluid-dynamics-an-the-finite-volume-method/P200000005670/9780131274983), wherein the algebraic formulation is obtained by discretizing the equation on a 2-dimensional grid. The current version of the project uses pre-defined discretization schemes. The temporal term is discretized using the first order accurate explicit Euler method, whereas the advection and diffusion terms are discretized using the [First Order Upwind (FOU)](https://en.wikipedia.org/wiki/Upwind_scheme) and the [central differencing scheme](https://en.wikipedia.org/wiki/Central_differencing_scheme) respectively.

### Code Structure

The `src` folder contains all the source files of the project. `solver.cpp` contains the structure of the solver and the input parameters are defined in `parameters.cpp`. `mesh.cpp` contains the definition of the mesh, whereas the `explicit.cpp` file has the definitions of the initial and boundary conditions along with the explicit algebraic equation solution. There is also an `export.cpp` file, that is used to generate output files in [VTK](https://vtk.org/) format.

## Usage

The user needs to install a C++ compiler and CMake to run this solver. This can be done using the following commands:
```
sudo apt install g++
sudo apt install cmake
```
The user can also check if they are already installed by checking `g++ --version` and `cmake --version`. Once the dependencies are installed, a makefile needs to be generated using `cmake /src/`. Through this, the user can simply run `make` to compile the solver and run it by using `./solver`. 

To set up the solver, the user can modify the parameters given in `parameters.cpp`. The details of the parameters are listed as follows:
- `NI` : Number of grid cells in the x-direction
- `NJ` : Number of grid cells in the y-direction
- `L` : Length of the computational domain
- `H` : Height of the computational domain
- `DELT` : Time-step size for the simulation (Note that the current version only has a explicit formulation, so the users are instructed to set a time-step based on the stability criteria)
- `TMAX` : Time till which the simulation should be run
- `U` : Advection velocity in the x-direction
- `V` : Advection velocity in the y-direction
- `DIFF` : Value of the diffusion coefficient
- `WRITE_INTERVAL` : The number of time-steps after which output files should be generated

The solver also allows the user to select the initial and boundary consitions. The initial distribution can be set using the `INITPHI` variable. Two options are provided for the boundary conditions: a fixed value [(Dirichlet boundary condition)](https://en.wikipedia.org/wiki/Dirichlet_boundary_condition) or a fixed gradient [(Neumann boundary condition)](https://en.wikipedia.org/wiki/Neumann_boundary_condition). (Note that a positive gradient represents and inward flux.) The boundary condition can be selected at the west, east, south and north by setting the variables `BCW`, `BCE`, `BCS` and `BCN` to 1 (fixed value) or -1 (fixed gradient) respectively. The value of the scalar or the gradient can be specified using the `BCVAL` variables.

The solver generates output files in the VTK format. To visualize the data generated by the solver, the users are suggested to use [ParaView](https://www.paraview.org/), an open-source post-processing software.

## Validation

To validate the solver, the results are compared for a problem with a known analytical solution. The length and height of the computational domain are 20 and 1 respectively. $\phi$ is set to be 0 everywhere in the domain initially. At the west boundary, $\phi$ is set to be 1, whereas at the south and north boundaries, it is set to 0. A zero-gradient boundary condition is applied at the east-boundary. The advection velocities $u$ and $v$ are chosen as 1 and 0 respectively and the diffusion coefficient is $\frac{1}{70}$ ($Re=100, Pr=0.7$). The analytical solution for this problem (given by [Burmeister (1993)](https://www.wiley.com/en-sg/Convective+Heat+Transfer,+2nd+Edition-p-9780471577096)) is as follows:

```math
$\phi(X,Y)=\frac{4}{\pi} \displaystyle\sum_{n=0}^{\infty} \frac{(-1)^n}{2n+1} \cos[\eta(Y-0.5)] \exp[-\eta^2 \frac{X}{Re Pr}]$
where, $\eta=(2n+1)\pi$
```

The comparison of the profiles of $\phi$ at $X=1, 3$ and $5$ with the analytical solution are given below for three different grid sizes:

![](https://hedgedoc.rbg.tum.de/uploads/d13322c91e7593cc2417dcb60.jpg)
<br><br>
![](https://hedgedoc.rbg.tum.de/uploads/d13322c91e7593cc2417dcb61.jpg)
<br><br>
![](https://hedgedoc.rbg.tum.de/uploads/d13322c91e7593cc2417dcb62.jpg)

The computed results show good agreement with the analytical solution despite the use of low-order discretization scheme. The graphs also show the convergent behaviour of the method.

## Future improvements

- In the next version, the user will have the option to choose between different discretization schemes as well as the option to choose between an implicit or explicit solver.
- The current version requires the user to re-compile the solver if the parameters are changed. This will be addressed in the next version, wherein the parameters will be read from an input file. 
- We plan to extend the number of formats for the output files (such as CSV and DAT) to give the users more freedom in choosing their post-processing software.


